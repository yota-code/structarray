#!/usr/bin/env python3

import argparse
import collections
import hashlib
import sys

import brotli
import h5py

import numpy as np

from cc_pathlib import Path

import structarray.rezip

parser = argparse.ArgumentParser(description='Convert a .reb file to hdf5')

parser.add_argument('data', metavar='DATA', type=Path, help='the data (*.reb) file')
parser.add_argument('--meta', metavar='META', type=Path, help='the meta (*.tsv) file')

p = parser.parse_args()

data_pth = p.data.resolve()
hdf5_pth = data_pth.with_suffix('.hdf5')

rez = structarray.rezip.RezHandler(hdf5_pth)
rez.convert_from_reb(data_pth)


